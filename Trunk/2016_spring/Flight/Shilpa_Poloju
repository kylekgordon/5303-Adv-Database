### Title: Sql Flight Assignment
### Name: Shilpa Poloju
…………………………………………………………………………..
###Question 1:
Print a passenger list for flight 3 on 4-1

SQL :
'''
SELECT p.name
FROM passengers p
INNER JOIN pass_ticketed t ON t.passid = p.passid
WHERE t.date = ‘4-1’
AND t.fltno = 3
LIMIT 0,30 

###Answer:
'''
name
Duck, Donald
Wayne, John
Mazurki, Mike
Marvin, Lee
Romero, Cesar
Lamour, Dorothy
'''

###Question 2:
Print a passenger list for flight 5 on 4-2
 
SQL :
'''
SELECT p.name
FROM passengers p
INNER JOIN pass_ticketed t ON t.passid = p.passid
WHERE t.date =  '4-2'
AND t.fltno =5
LIMIT 0 , 30

###Answer:
'''
name
Mouse, Mickey
Moose, Bullwinkle
'''

###Question 3:
Print a list of all overbooked flights.

SQL :
'''
SELECT a.acno
FROM (

SELECT aa.acno, COUNT( * ) AS capc
FROM pass_ticketed t, aircraft_assignments aa
WHERE t.fltno = aa.fltno
AND t.date = aa.date
GROUP BY t.fltno, t.date
)a, aircraft c
WHERE a.acno = c.acno
AND a.capc > c.capacity
LIMIT 0 , 30
'''

###Answer:
'''
acno
N173WY
'''

###Question 4:
Print a list of passengers with more than one ticket.

SQL :
'''
SELECT name
FROM passengers p
JOIN pass_ticketed t ON p.passid = t.passid
GROUP BY p.passid
HAVING COUNT( * ) >1
LIMIT 0 , 30
'''

###Answer:
'''
name
Simpson, Richard
Halverson, Ranette
Carpenter, Stewart
Wayne, John
Mazurki, Mike
Marvin, Lee
Lamour, Dorothy
Mouse, Mickey
Duck, Donald
Moose, Bullwinkle
'''

###Question 5:
Print a list of passengers with more than one ticket on the same day.

SQL :
'''
SELECT p.name
FROM passengers p
WHERE p.passid
IN (

SELECT t.passid
FROM pass_ticketed t
GROUP BY t.passid, t.date
HAVING COUNT( * ) >1
)
LIMIT 0 , 30
'''

###Answer
'''
name
Simpson, Richard
Carpenter, Stewart
Duck, Donald
Wayne, John
Marvin, Lee
Lamour, Dorothy

'''

###Question 6:
Print a list of flights that use aircraft N173WY.

SQL:
'''
SELECT DISTINCT (fltno)
FROM aircraft_assignments
WHERE acno ='N173WY'
LIMIT 0 , 30
'''
###Answer:
'''
fltno
2
5
1
4
'''



###Question 7:
Print a list of pilots who fly on April 1.

SQL:
'''
SELECT a.name
FROM pilots a
JOIN pilot_assignments x ON a.pilotid = x.pilotid
WHERE x.date =  '4-1'
LIMIT 0 , 30
'''

###Answer:
'''
name
Wright, Orville
Post, Wiley
Lindergh, Charles
Yeager, Chuck
Wright, Orville
Post, Wiley
Lindergh, Charles
'''

###Question 8:
Print a list of pilots who fly on both days.

SQL:
'''
SELECT p.pilotid
FROM pilot_assignments p, pilot_assignments p1
WHERE p.pilotid = p1.pilotid
AND p.date != p1.date
GROUP BY p.pilotid
LIMIT 0 , 30
'''

###Answer:
'''
pilotid
241
1030
7305
'''

###Question 9:
Print a list of pilots who have two flights on the same day.

SQL:
'''
SELECT p.pilotid, p.date
FROM pilot_assignments p
GROUP BY p.pilotid, p.date
HAVING COUNT( * ) =2
LIMIT 0 , 30
'''

###Answer:
'''
pilotid date
29      4-2
1030    4-1
2137    4-1
4315    4-2
7305    4-1
'''

###Question 10:
Print a List of flights that do not have a complete crew.

SQL:
'''
'''




###Question 11:
Print of list of flights where destination is DFW.

SQL:
'''
SELECT DISTINCT (
fltno
)
FROM flights
WHERE destination =  'DFW'
LIMIT 0 , 30
'''

###Answer:
'''
fltno
4
5
6
'''

###Question 12:
Print a list of flights where origin or destination is LAX.

SQL:
'''
SELECT fltno
FROM flights
WHERE destination =  'LAX'
OR origin =  'LAX'
LIMIT 0 , 30
'''

###Answer:
'''
fltno
3
6
3
'''

###Question 13:
Print the origin and destination of flights with passenger equals Duck, Donald or Wayne, John.

SQL:
'''
SELECT DISTINCT (
f.origin
), f.destination
FROM flights f
INNER JOIN pass_ticketed t ON f.fltno = t.fltno
INNER JOIN passengers p ON p.passid = t.passid
WHERE p.name =  'Duck, Donald'
OR p.name =  'Wayne, John'
LIMIT 0 , 30
'''

###Answer:
'''
origin destination
DFW    LAX
LAX    DFW
ORD    DFW
DIA    DFW
'''

###Question 14:
Print a list of flight numbers and origins.

SQL:
'''
SELECT DISTINCT (
FLTNO
), ORIGIN
FROM flights
LIMIT 0 , 30
'''

###Answer:
'''
FLTNO ORIGIN
1      DFW
2      DFW
3      DFW
4      DIA
5      ORD
6      LAX
'''

###Question 15:
Print a list of aircraft types from equipment assigned where pilot number=1030.

SQL:
'''
SELECT DISTINCT (
a.type
)
FROM aircraft a
JOIN aircraft_assignments aa ON a.acno = aa.acno
JOIN pilot_assignments pa ON pa.fltno = aa.fltno
WHERE pa.pilotid =  '1030'
LIMIT 0 , 30
'''

###Answer:
'''
type
B-18
C-172
'''

###Question 16:
Print a list of pilots who fly with at least two other pilots.

SQL:
'''
SELECT p.pilotid
FROM (
		SELECT pa.pilotid, pa.date, pa.fltno
		FROM pilot_assignments pa
		GROUP BY pa.date, pa.fltno
		HAVING COUNT( * ) >2
	)p, pilot_assignments pas
WHERE pas.date = pas.date
AND p.fltno = pas.fltno
LIMIT 0 , 30

'''

###Answer:
'''
returns empty result
'''

###Question 17:
Print a list of pilots who fly only one type of plane.

SQL:
'''
'''

###Question 18:
Print a list of passengers booked on flights assigned to pilot=1030.

SQL:
'''
SELECT DISTINCT (
t.passid
)
FROM pass_ticketed t
JOIN pilot_assignments a ON a.fltno = t.fltno
WHERE a.pilotid =1030
LIMIT 0 , 30
'''

###Answer:
'''
passid
1001
1002
1004
1103
1003
1011

'''

###Question 19:
Print a list of pilots assigned to fly plane=N35A.

SQL:
'''
SELECT DISTINCT (
p.name
)
FROM pilots p
JOIN pilot_assignments a
JOIN aircraft_assignments c ON a.fltno = c.fltno
AND a.pilotid = p.pilotid
WHERE c.acno =  'N35A'
LIMIT 0 , 30
'''

###Answer:
'''
name
Wright, Orville
Post, Wiley
Lindergh, Charles
Lovell, James
Wittman. Steve

'''