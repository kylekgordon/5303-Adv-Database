### Title: Sql Flight Assignment
### Name : Nanda Kishore Tokala

#### Question 1:
Print a passenger list for flight 3 on 4-1

SQL:
'''
SELECT passengers.name
FROM pass_ticketed, passengers
WHERE pass_ticketed.passid = passengers.passid
AND pass_ticketed.fltno =3
AND DATE =  '4-1'
LIMIT 0 , 30
'''

#### Answer:
'''
Duck, Donald
Wayne, John
Mazurki, Mike
Marvin, Lee
Romero, Cesar
Lamour, Dorothy
'''

#### Question 2:
Print a passenger list for flight 5 on 4-2

SQL:

'''
SELECT passengers.name
FROM pass_ticketed, passengers
WHERE pass_ticketed.passid = passengers.passid
AND pass_ticketed.fltno =5
AND DATE =  '4-2'
LIMIT 0 , 30
'''

#### Answer:

'''
Mouse, Mickey
Moose, Bullwinkle
'''

#### Question 3:
Print a list of all overbooked flights.

SQL:

'''
SELECT x.accno, x.fno, x.pdate
FROM (

SELECT pt.fltno AS fno, pt.date AS pdate, asm.acno AS accno, count( * ) AS pascount
FROM pass_ticketed pt, aircraft_assignments asm
WHERE pt.fltno = asm.fltno
AND pt.date = asm.date
GROUP BY pt.fltno, pt.date
)x, aircraft y
WHERE x.accno = y.acno
AND x.pascount > y.capacity
LIMIT 0 , 30
'''

#### Answer:

'''
N173WY  2 4-1
'''

#### Question 4:
Print a list of passengers with more than one ticket.

SQL:

'''
SELECT ps.name
FROM (
SELECT pt.passid AS pasid
FROM pass_ticketed pt
GROUP BY pt.passid
HAVING count( * ) >1
) AS x, passengers ps
WHERE x.pasid = ps.passid
LIMIT 0 , 30
'''

#### Answer:

'''
Simpson, Richard
Halverson, Ranette
Carpenter, Stewart
Mouse, Mickey
Duck, Donald
Moose, Bullwinkle
Wayne, John
Mazurki, Mike
Marvin, Lee
Lamour, Dorothy
'''

#### Question 5:
Print a list of passengers with more than one ticket on the same day.

SQL:

'''
SELECT ps.name
FROM (

SELECT pt.passid AS pasid, pt.date
FROM pass_ticketed pt
GROUP BY pt.passid, pt.date
HAVING count( * ) >1
)x, passengers ps
WHERE x.pasid = ps.passid
LIMIT 0 , 30
'''

#### Answer:

'''
Simpson, Richard
Carpenter, Stewart
Duck, Donald
Wayne, John
Marvin, Lee
Lamour, Dorothy
'''

#### Question 6:
Print a list of flights that use aircraft N173WY.

SQL:

'''
SELECT DISTINCT (
fltno
)
FROM aircraft_assignments
WHERE acno =  'N173WY'
LIMIT 0 , 30
'''

#### Answer:

'''
2
5
1
4
'''

#### Question 7:
Print a list of pilots who fly on April 1.

SQL:

'''
SELECT p.pilotid, p.name
FROM `pilot_assignments` pa, pilots p
WHERE p.pilotid = pa.pilotid
AND pa.date = '4-1'
LIMIT 0 , 30
'''

#### Answer:

'''
1030 Wright, Orville
2137 Lindergh, Charles
241  Yeager, Chuck
7305 Post, Wiley
'''

#### Question 8:
Print a list of pilots who fly on both days.

SQL:

'''
SELECT p.pilotid,p.name
FROM pilots p
WHERE p.pilotid
IN (
SELECT ps1.pilotid
FROM `pilot_assignments` ps1, pilot_assignments ps2
WHERE ps1.pilotid = ps2.pilotid
AND ps1.date != ps2.date
GROUP BY ps1.pilotid
HAVING count( * ) >1
)
LIMIT 0 , 30
'''

#### Answer:

'''
1030 Wright, Orville
241  Yeager, Chuck
7305 Post, Wiley
'''

#### Question 9:
Print a list of pilots who have two flights on the same day.

SQL:

'''
SELECT ps1.pilotid, ps1.date, count( * )
FROM `pilot_assignments` ps1
GROUP BY ps1.pilotid, ps1.date
HAVING count( * ) =2
LIMIT 0 , 30
'''

#### Answer:

'''

pilotid  date  count( * )
29        4-2    2
1030      4-1    2
2137      4-1    2
4315      4-2    2
7305      4-1    2  
'''

#### Question 10:
Print a List of flights that do not have a complete crew.

SQL:

'''
SELECT y.acno, x.dt, x.flno
FROM (

SELECT ps.date AS dt, ps.fltno AS flno, COUNT( * ) AS pilotcount, air.acno AS accno
FROM  `pilot_assignments` ps, aircraft_assignments air
WHERE ps.date = air.date
AND ps.fltno = air.fltno
GROUP BY ps.date, ps.fltno, air.acno
) AS x, aircraft y
WHERE x.pilotcount < y.pilots
AND x.accno = y.acno
LIMIT 0 , 30
'''

#### Answer:

'''
N412B  4-1 3
N747UA 4-2 3
N412B  4-2 6
'''

#### Question 11:
Print of list of flights where destination is DFW.

SQL:

'''
SELECT air.acno, destination,fl.fltno
FROM `flights` fl, aircraft_assignments air
WHERE destination = 'DFW'
AND fl.date = air.date
AND fl.fltno = air.fltno
LIMIT 0 , 30
'''

#### Answer:

'''

acno     destination    fltno
N35A      DFW           4
N173WY    DFW           5
N412B     DFW           6
N173WY    DFW           4
N35A      DFW           5

'''

#### Question 12:
Print a list of flights where origin or destination is LAX

SQL:

'''
SELECT air.acno,destination, origin
FROM `flights` fl, aircraft_assignments air
WHERE (
destination = 'LAX'
OR origin = 'LAX'
)
AND fl.date = air.date
AND fl.fltno = air.fltno
LIMIT 0 , 30
'''

#### Answer:

'''
acno   destination  origin
N412B   LAX         DFW
N412B   DFW         LAX
N747UA  LAX         DFW
'''

#### Question 13:
Print the origin and destination of flights with passenger equals Duck, Donald or Wayne, John.

SQL:

'''
SELECT pt.date, pt.fltno, f.origin, f.destination
FROM pass_ticketed pt, aircraft_assignments air, flights f
WHERE pt.date = air.date
AND pt.fltno = air.fltno
AND f.fltno = air.fltno
AND f.date = air.date
AND passid
IN (

SELECT passid
FROM  `passengers` ps
WHERE ps.name
IN (
 'Duck, Donald',  'Wayne, John'
)
)
'''

#### Answer:

'''

date fltno origin destination
4-1  3     DFW         LAX
4-1  3     DFW         LAX
4-2  6     LAX         DFW
4-1  5     ORD         DFW
4-1  4     DIA          DFW

'''

#### Question 14:
Print a list of flight numbers and origins.

SQL:

'''
SELECT DISTINCT (
fltno
), origin
FROM flights
LIMIT 0 , 30
'''
#### Answer:

'''
1 DFW
2 DFW
3 DFW
4 DIA
5 ORD
6 LAX
'''

#### Question 15:
Print a list of aircraft types from equipment assigned where pilot number=1030.

SQL:

'''
SELECT DISTINCT (
a.type
)
FROM  `aircraft_assignments` air, pilot_assignments ps, aircraft a
WHERE air.date = ps.date
AND air.fltno = ps.fltno
AND a.acno = air.acno
AND ps.pilotid =1030
LIMIT 0 , 30
'''

#### Answer:

'''
C-172
B-18
'''

#### Question 16:
Print a list of pilots who fly with at least two other pilots.

SQL:

'''
SELECT pilotid
FROM (

SELECT date, fltno, count( * )
FROM `pilot_assignments`
WHERE 1
GROUP BY date, fltno
HAVING count( * ) >2
LIMIT 0 , 30
)x, pilot_assignments ps
WHERE x.date = ps.date
AND x.fltno = ps.fltno
LIMIT 0 , 30
'''

#### Answer:

'''
No columns selected
'''

#### Question 17:
Print a list of pilots who fly only one type of plane.

SQL:

'''
'''

#### Answer:
'''
'''


#### Question 18:
Print a list of passengers booked on flights assigned to pilot=1030.

SQL:

'''
SELECT pt.passid
FROM `pilot_assignments` ps, pass_ticketed pt
WHERE pilotid =1030
AND pt.date = ps.date
AND ps.fltno = pt.fltno
LIMIT 0 , 30
'''

#### Answer:

'''

passid
1001
1002
1004
1103
1003
1011
'''

#### Question 19:
Print a list of pilots assigned to fly plane=N35A.

SQL:

'''
SELECT ps.pilotid
FROM `aircraft_assignments` air, pilot_assignments ps
WHERE air.acno = 'N35A'
AND air.date = ps.date
AND air.fltno = ps.fltno
LIMIT 0 , 30
'''

#### Answer:

'''

pilotid
1030
7305
1030
7305
4315
29
4315
29
'''