### Title: Sql Flight Assignment
### Name : Majesh Reddy Salla

#### Question 1:
Print a passenger list for flight 3 on 4-1

SQL:
'''
SELECT p.name 
FROM passengers p, pass_ticketed pa 
WHERE pa.fltno=3 
AND pa.date='4-1' 
AND p.passid=pa.passid
LIMIT 0 , 30
'''

#### Answer:
'''
Duck, Donald
Wayne, John
Mazurki, Mike
Marvin, Lee
Romero, Cesar
Lamour, Dorothy
'''

#### Question 2:
Print a passenger list for flight 5 on 4-2

SQL:

'''
SELECT p.name 
FROM passengers p, pass_ticketed pa 
WHERE pa.fltno=5 
AND pa.date='4-2' 
AND p.passid=pa.passid
LIMIT 0 , 30
'''

#### Answer:

'''
Mouse, Mickey
Moose, Bullwinkle
'''

#### Question 3:
Print a list of all overbooked flights.

SQL:

'''
SELECT x.accno, x.fno, x.pdate
FROM (

SELECT pt.fltno AS fno, pt.date AS pdate, asm.acno AS accno, count( * ) AS pascount
FROM pass_ticketed pt, aircraft_assignments asm
WHERE pt.fltno = asm.fltno
AND pt.date = asm.date
GROUP BY pt.fltno, pt.date
)x, aircraft y
WHERE x.accno = y.acno
AND x.pascount > y.capacity
LIMIT 0 , 30
'''

#### Answer:

'''
N173WY  2 4-1
'''

#### Question 4:
Print a list of passengers with more than one ticket.

SQL:

'''
SELECT p.name
FROM passengers p, pass_ticketed ticket
WHERE p.passid = ticket.passid
GROUP BY ticket.passid
HAVING COUNT( * ) >1
LIMIT 0 , 30
'''

#### Answer:

'''
name
Simpson, Richard
Halverson, Ranette
Carpenter, Stewart
Wayne, John
Mazurki, Mike
Marvin, Lee
Lamour, Dorothy
Mouse, Mickey
Duck, Donald
Moose, Bullwinkle
'''

#### Question 5:
Print a list of passengers with more than one ticket on the same day.

SQL:

'''
SELECT p.name
FROM passengers p, pass_ticketed ticket
WHERE p.passid = ticket.passid
GROUP BY ticket.passid, ticket.date
HAVING COUNT( * ) >1
LIMIT 0 , 30
'''

#### Answer:

'''
name
Simpson, Richard
Carpenter, Stewart
Wayne, John
Marvin, Lee
Lamour, Dorothy
Duck, Donald
'''

#### Question 6:
Print a list of flights that use aircraft N173WY.

SQL:

'''
SELECT fltno
FROM aircraft_assignments
WHERE acno =  'N173WY'
LIMIT 0 , 30
'''

#### Answer:

'''
2
5
1
4
'''

#### Question 7:
Print a list of pilots who fly on April 1.

SQL:

'''
SELECT DISTINCT p.name
FROM pilots p, pilot_assignments pa
WHERE p.pilotid = pa.pilotid
AND pa.date =  '4-1'
LIMIT 0 , 30
'''

#### Answer:

'''
name
Wright, Orville
Post, Wiley
Lindergh, Charles
Yeager, Chuck
'''

#### Question 8:
Print a list of pilots who fly on both days.

SQL:

'''
SELECT p.name
FROM pilot_assignments pa, pilot_assignments pa1, pilots p
WHERE pa.pilotid = pa1.pilotid
AND pa.date != pa1.date
AND p.pilotid = pa.pilotid
GROUP BY pa.pilotid
HAVING COUNT( * ) >1
LIMIT 0 , 30
'''

#### Answer:

'''
name
Yeager, Chuck
Wright, Orville
Post, Wiley
'''

#### Question 9:
Print a list of pilots who have two flights on the same day.

SQL:

'''
SELECT pa.pilotid
FROM pilot_assignments pa
GROUP BY pa.pilotid, pa.date
HAVING COUNT( * ) =2
LIMIT 0 , 30
'''

#### Answer:

'''
pilotid
29
1030
2137
4315
7305
'''

#### Question 10:
Print a List of flights that do not have a complete crew.

SQL:

'''
SELECT y.acno, x.dt, x.flno
FROM (

SELECT ps.date AS dt, ps.fltno AS flno, COUNT( * ) AS pilotcount, air.acno AS accno
FROM  `pilot_assignments` ps, aircraft_assignments air
WHERE ps.date = air.date
AND ps.fltno = air.fltno
GROUP BY ps.date, ps.fltno, air.acno
) AS x, aircraft y
WHERE x.pilotcount < y.pilots
AND x.accno = y.acno
LIMIT 0 , 30
'''

#### Answer:

'''
N412B  4-1 3
N747UA 4-2 3
N412B  4-2 6
'''

#### Question 11:
Print of list of flights where destination is DFW.

SQL:

'''
SELECT DISTINCT fltno
FROM flights
WHERE destination =  'DFW'
LIMIT 0 , 30
'''

#### Answer:

'''
fltno
4
5
6
'''

#### Question 12:
Print a list of flights where origin or destination is LAX

SQL:

'''
SELECT DISTINCT fltno
FROM flights
WHERE origin =  'LAX'
OR destination =  'LAX'
LIMIT 0 , 30
'''

#### Answer:

'''
fltno
3
6
'''

#### Question 13:
Print the origin and destination of flights with passenger equals Duck, Donald or Wayne, John.

SQL:

'''
SELECT f.origin, f.destination
FROM flights f
WHERE fltno
IN (
SELECT pt.fltno
FROM pass_ticketed pt
WHERE passid
IN (
SELECT pa.passid 
FROM passengers pa
WHERE name
IN (
'Duck, Donald',  'Wayne, John'
)
)
)
LIMIT 0 , 30
'''

#### Answer:

'''
origin destination
DFW		LAX
DIA		DFW
ORD		DFW
LAX		DFW
DFW		LAX
DIA		DFW
ORD		DFW
'''

#### Question 14:
Print a list of flight numbers and origins.

SQL:

'''
SELECT DISTINCT fltno, origin
FROM flights
LIMIT 0 , 30
'''
#### Answer:

'''
1 DFW
2 DFW
3 DFW
4 DIA
5 ORD
6 LAX
'''

#### Question 15:
Print a list of aircraft types from equipment assigned where pilot number=1030.

SQL:

'''
SELECT DISTINCT a.type
FROM aircraft a, aircraft_assignments aa, pilot_assignments pa
WHERE a.acno = aa.acno
AND aa.fltno = pa.fltno
AND pa.pilotid =1030
LIMIT 0 , 30
'''

#### Answer:

'''
type
B-18
C-172
'''

#### Question 16:
Print a list of pilots who fly with at least two other pilots.

SQL:

'''
SELECT pilotid
FROM (
SELECT date, fltno, count( * )
FROM `pilot_assignments`
WHERE 1
GROUP BY date, fltno
HAVING count( * ) >2
LIMIT 0 , 30
)x, pilot_assignments ps
WHERE x.date = ps.date
AND x.fltno = ps.fltno
LIMIT 0 , 30
'''

#### Answer:

'''
NO Columns are selected
'''

#### Question 18:
Print a list of passengers booked on flights assigned to pilot=1030.

SQL:

'''
SELECT DISTINCT p.name
FROM passengers p, pass_ticketed pt, pilot_assignments pa
WHERE p.passid = pt.passid
AND pt.fltno = pa.fltno
AND pilotid =1030
LIMIT 0 , 30
'''

#### Answer:

'''
name
Simpson, Richard
Halverson, Ranette
Griffin, Terry
Bunny, Bugs
Carpenter, Stewart
Wayne, John
'''

#### Question 19:
Print a list of pilots assigned to fly plane=N35A.

SQL:

'''
SELECT DISTINCT p.name
FROM pilots p, pilot_assignments pa, aircraft_assignments aa
WHERE p.pilotid = pa.pilotid
AND pa.fltno = aa.fltno
AND aa.acno =  'N35A'
LIMIT 0 , 30
'''

#### Answer:

'''
name
Wright, Orville
Post, Wiley
Lindergh, Charles
Lovell, James
Wittman. Steve
'''